<!doctype html><html lang=en><head><title>Everyday :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/categories/everyday/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Everyday :: XenoBlog"><meta property="og:description" content><meta property="og:url" content="/categories/everyday/"><meta property="og:site_name" content="Everyday"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><link href=/categories/everyday/index.xml rel=alternate type=application/rss+xml title=XenoBlog></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://github.com/claustn>github</a></li><li><a href=https://xipher.dk/index.xml>RSS</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://github.com/claustn>github</a></li><li><a href=https://xipher.dk/index.xml>RSS</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=/posts/2013-08-02-managing-queue-it-queues-with-powershell/>Managing Queue-It queues with PowerShell</a></h1><div class=post-meta><span class=post-date>2013-08-02</span></div><div class=post-content>We are using Queue-IT for some of our external websites, and we needed to start/stop the queues when we doing maintenance on our sites, I found this very easy to do, with Powershell’s Invoke-WebRequest cmdlet.
Here are a few examples.
&amp;lt;# # Script to Pause Queue-IT Logs # MaxRedirectPerMin number of requests passed to site/minute # QueueStatus 1 = Queue Open, 2 = Queue Paused. #&amp;gt; # Pauses the Queue MySite" Invoke-WebRequest -Uri "https://api.</div><div><a class="read-more button" href=/posts/2013-08-02-managing-queue-it-queues-with-powershell/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=/posts/2013-06-27-culture-gotchas/>Culture Gotchas</a></h1><div class=post-meta><span class=post-date>2013-06-27</span></div><div class=post-content><p>We are not everyone running Powershell on machines with ”en-US” locale, and sometimes that gives some unexpected problems, if you are running on a non US system, and have been working with Excel for instance, you have probably run into this error when trying to add something to Excel like this:
$xl= New-Object -COM Excel.Application
$xl.Visible = $true
$wb=$xl.Workbooks.Add()</p><p>I stumbled upon another culture “gotcha” when trying to get some eventlog info using (Wasn’t obvious to me at the time it was a Culture issue)</p></div><div><a class="read-more button" href=/posts/2013-06-27-culture-gotchas/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=/posts/2013-04-15-sending-out-password-expiration-mails-to-users-in-active-directory/>Sending out Password Expiration mails to users in Active Directory</a></h1><div class=post-meta><span class=post-date>2013-04-15</span></div><div class=post-content>I was tasked with writing a script that would send out an e-mail to users, when there were 14,7,3,2 and 1 days before their AD passwords expired.
I use the Quest AD cmdlets to get users from AD.
if (!(Get-PSSnapin Quest.ActiveRoles.ADManagement -ErrorAction SilentlyContinue)) { Add-PSSnapin Quest.ActiveRoles.ADManagement } $mailfrom = "IT@XXXXXX.DK" $smtpsrv = "MailServerName" #Getting the Default maximum password age from AD $MaxPassAge = (Get-QADObject (Get-QADRootDSE).defaultNamingContextDN).MaximumPasswordAge.days #Getting a list of AD users, who&rsquo;s password doesn&rsquo;t expire, and adding a calculated value, with the amount of days till the password expires.</div><div><a class="read-more button" href=/posts/2013-04-15-sending-out-password-expiration-mails-to-users-in-active-directory/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=/posts/2012-09-10-troubleshooting-test-connection/>Troubleshooting Test-Connection</a></h1><div class=post-meta><span class=post-date>2012-09-10</span></div><div class=post-content>I was contacted by a friend who was having some issues with Test-Connection when using TimeToLive
Example:
Test-Connection -ComputerName <a href=http://www.google.ie>www.google.ie</a> -Count 1 -TimeToLive 3
Test-Connection : Testing connection to computer ‘www.google.ie’ failed: Problem with some part of the filterspec or providerspecific buffer in general
At line:1 char:1
Test-Connection -ComputerName <a href=http://www.google.ie>www.google.ie</a> -TimeToLive 3
 + CategoryInfo : ResourceUnavailable: (<a href=http://www.google.ie>www.google.ie</a>:String) [Test-Connection], PingException
 + FullyQualifiedErrorId : TestConnectionException,Microsoft.</div><div><a class="read-more button" href=/posts/2012-09-10-troubleshooting-test-connection/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=/posts/2012-01-25-checking-site-sizes-in-sharepoint-2007-and-2010/>Checking Site sizes in SharePoint 2007 and 2010</a></h1><div class=post-meta><span class=post-date>2012-01-25</span></div><div class=post-content>Our Sharepoint admin asked me to help him write a script, that found out how much space each DocumentLibrary in our sharepoint farm took up, so after some googeling I found that I could use the StorageManagementInformation Method on the SPSite object, so I cam up with this little script
[ps]
#First we load the SharePoint assembly
[void][System.Reflection.Assembly]::LoadWithPartialName(“Microsoft.SharePoint”)
#Then we create a function that returns tje SPSite
function Get-SPSite($url){
return new-Object Microsoft.</div><div><a class="read-more button" href=/posts/2012-01-25-checking-site-sizes-in-sharepoint-2007-and-2010/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=/posts/2011-10-09-updating-htacces-file-based-on-apache-log-files/>Updating .Htacces file based on Apache log files</a></h1><div class=post-meta><span class=post-date>2011-10-09</span></div><div class=post-content>I am still seeing massive amounts of referal traffic hitting my site, eating up my bandwidth.. I did not get time to update my .htaccess file for the last 2 days.. and within the last 24 hours I have had more than 6000 hits, generating in almost 24.000 pageviews… Generating more than 1 GB worth of traffic (So at that speed I will reach my 10 GB limit soon)
Looking through the Apache logs, figuring out which sites I get most referral traffic from, getting the hostnames, transforming them into a format that can be used by the Apache rewrite engine in the .</div><div><a class="read-more button" href=/posts/2011-10-09-updating-htacces-file-based-on-apache-log-files/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=/posts/2011-09-18-finally-got-confirmation-grown-men-do-cry-when-their-bitlocker-encrypted-ssd-disk-dies/>Finally got confirmation.. Grown men do cry when their Bitlocker encrypted SSD disk dies ;(</a></h1><div class=post-meta><span class=post-date>2011-09-18</span></div><div class=post-content>Had another visit from the ever present Mr Murphy, I have had a Lenovo T420 sitting on my desk for a while, as a replacement for my T410.. Finally last night I had some time to start moving over data to the new laptop. So I boot up both laptops, both have Windows Updates ready to install.. So I thought, I might as well, let it update, while I went out to get me something to drink.</div><div><a class="read-more button" href=/posts/2011-09-18-finally-got-confirmation-grown-men-do-cry-when-their-bitlocker-encrypted-ssd-disk-dies/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=/posts/2011-09-05-back-to-my-old-theme-again/>Back to my old theme again</a></h1><div class=post-meta><span class=post-date>2011-09-05</span></div><div class=post-content></div><div><a class="read-more button" href=/posts/2011-09-05-back-to-my-old-theme-again/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=/posts/2011-09-02-testing-simple-theme/>Testing simple theme</a></h1><div class=post-meta><span class=post-date>2011-09-02</span></div><div class=post-content></div><div><a class="read-more button" href=/posts/2011-09-02-testing-simple-theme/>Read more →</a></div></div><div class="post on-list"><h1 class=post-title><a href=/posts/2011-06-17-fix-2008r2-scheduled-tasks/>Fix 2008R2 scheduled tasks</a></h1><div class=post-meta><span class=post-date>2011-06-17</span></div><div class=post-content>[ps]
Function Change-ScheduledTask {
Param($XMLIn)
$ShortDate = [regex]"(?&lt;shortdate>[0-9]{4}/.-/.-T(?:2[0-3]|[01][0-9])[:.][0-5][0-9][:.][0-5][0-9])(?&lt;digits>.\d*)”
foreach ($line in $XMLIn){
If ($line -match “$ShortDate”) {
$line = [regex]::Replace($line, $ShortDate, $($Matches[“Shortdate”]))
}
$line
#$Script:outfile += $line + “`n”
}
}
Function Remove-ScheduledTask {
}
Function New-ScheduledTask {
}
$schtask = Schtasks.exe /query /s “localhost” /V /FO CSV | ConvertFrom-Csv
if ($schtask) {
Foreach ($sch in $schtask) {
if ($Sch.“Run As User” -like “$($domainname)*") {
$sch
}
}
$outfile = "”</div><div><a class="read-more button" href=/posts/2011-06-17-fix-2008r2-scheduled-tasks/>Read more →</a></div></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=/categories/everyday/page/2/><span class=button__icon>←</span>
<span class=button__text>Newer posts</span></a></span>
<span class="button next"><a href=/categories/everyday/page/4/><span class=button__text>Older posts</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>