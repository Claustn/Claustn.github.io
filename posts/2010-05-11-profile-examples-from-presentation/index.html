<!doctype html><html lang=en><head><title>Profile Examples from Presentation :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Here are some of the scripts that I used during the demonstration in VA Beach.
Profiles:
Example #1
[ps]
function prompt
{
&amp;ldquo;Xenophane &amp;quot; + $(get-location) + &amp;ldquo;&amp;gt;&amp;rdquo;
}
[/ps]
Example #2
[ps]
function prompt
{
&amp;ldquo;Processes &amp;quot; + (Get-Process).Count+ &amp;quot; &amp;quot; + $(get-location) + &amp;ldquo;&amp;gt; &amp;quot;
}
[/ps]
Example #3 (Example taken from website)
[ps]
function Prompt
{
$id = 1
$historyItem = Get-History -Count 1
if($historyItem)
{
$id = $historyItem."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/2010-05-11-profile-examples-from-presentation/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Profile Examples from Presentation :: XenoBlog"><meta property="og:description" content="Here are some of the scripts that I used during the demonstration in VA Beach.
Profiles:
Example #1
[ps]
function prompt
{
&amp;ldquo;Xenophane &amp;quot; + $(get-location) + &amp;ldquo;&amp;gt;&amp;rdquo;
}
[/ps]
Example #2
[ps]
function prompt
{
&amp;ldquo;Processes &amp;quot; + (Get-Process).Count+ &amp;quot; &amp;quot; + $(get-location) + &amp;ldquo;&amp;gt; &amp;quot;
}
[/ps]
Example #3 (Example taken from website)
[ps]
function Prompt
{
$id = 1
$historyItem = Get-History -Count 1
if($historyItem)
{
$id = $historyItem."><meta property="og:url" content="/posts/2010-05-11-profile-examples-from-presentation/"><meta property="og:site_name" content="Profile Examples from Presentation"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Everyday"><meta property="article:published_time" content="2010-05-11 21:47:52 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://github.com/claustn>github</a></li><li><a href=/index.xml>RSS</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://github.com/claustn>github</a></li><li><a href=/index.xml>RSS</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/2010-05-11-profile-examples-from-presentation/>Profile Examples from Presentation</a></h1><div class=post-meta><span class=post-date>2010-05-11</span></div><span class=post-tags>#<a href=/tags/pofiles/>Pofiles</a>&nbsp;
#<a href=/tags/powershell/>PowerShell</a>&nbsp;</span><div class=post-content><div><p>Here are some of the scripts that I used during the demonstration in VA Beach.</p><p>Profiles:</p><p>Example #1</p><p>[ps]<br>function prompt<br>{<br>&ldquo;Xenophane " + $(get-location) + &ldquo;>&rdquo;<br>}<br>[/ps]</p><p>Example #2</p><p>[ps]<br>function prompt<br>{<br>&ldquo;Processes " + (Get-Process).Count+ " " + $(get-location) + &ldquo;> "<br>}<br>[/ps]</p><p>Example #3 (Example taken from website)</p><p>[ps]<br>function Prompt<br>{<br>$id = 1<br>$historyItem = Get-History -Count 1<br>if($historyItem)<br>{<br>$id = $historyItem.Id + 1<br>}</p><p>Write-Host -ForegroundColor DarkGray `n[$(Get-Location)]<br>Write-Host -NoNewLine PS$id<br>$host.UI.RawUI.WindowTitle = $(Get-Location)</p><p>`b<br>}<br>[/ps]</p><p>Example #4 (Overdone one)</p><p>[ps]<br>function prompt<br>{<br>[wmi]$Global:Cdrive=Get-WmiObject -query &ldquo;Select * from win32_logicaldisk where deviceid='c:'&rdquo;<br>#Define Cdrive as global variable, which is type cast as a wmi<br>$processcount=(Get-Process).Count<br>#Define variable processcount as number of processes running<br>$cpuload=(Get-WmiObject win32_processor).loadpercentage<br>#cpuload is defined as a variable<br>$diskinfoC=&rdquo; Free C: &ldquo;+&rdquo;{0:N2}&rdquo; -f (($global:Cdrive.freespace/1gb)/($global:cdrive.size/1gb)*100)+&rdquo;%&rdquo;<br>#diskinfoC is defined, {0:N2} is .NET for 2 decimal places, -f is a the &ldquo;format&rdquo; property of the string object.</p><h1 id=then-the-amount-of-free-space-on-drive-c-is-divided-by-the-size-of-drive-c-multiplies-by-100-to-get>Then the amount of free space on drive C is divided by the size of drive C multiplies by 100 to get<a href=#then-the-amount-of-free-space-on-drive-c-is-divided-by-the-size-of-drive-c-multiplies-by-100-to-get class=hanchor arialabel=Anchor>&#8983;</a></h1><p>#the percentage of free space.<br>$time=Get-WmiObject -class Win32_OperatingSystem<br>#Define $time is object Win32_OperatingSystem<br>$t=$time.ConvertToDateTime($time.Lastbootuptime)<br>#Define #t as the result of the convertion of LastBootuptime into a readable dateTime format.<br>[TimeSpan]$uptime=New-TimeSpan $t $(get-date)<br>#Typecast the variable $uptime as a [timespan], the timespan cmdlet in powershell is a way to do date arithmetic in ps<br>#This way we can compare our variable $t (Which was Lastbootuptime) and the current time Get-date cmdlet<br>$up="$($uptime.days)d $($uptime.hours)h $($uptime.minutes)m $($uptime.seconds)s&rdquo;<br>#define variable $up to display the uptime in days/hours/minuted/seconds<br>$TextToDisplay="CPU:&ldquo;+$cpuload+&rdquo;% Processes:&rdquo; + $processcount + $diskinfoC+ " " + $diskinfoG+ " &ldquo;+ ([char]0x25b2)+$up +&rdquo; &ldquo;+(Get-Date -format g)<br>#define one variable that contains all the data we collected so far.<br>Write-Host -fore red $TextToDisplay<br>#Write the information to the screen in red<br>Write-Host &ldquo;My PoSh:&rdquo; $(get-location) -nonewline<br>#Display the regular prompt.<br>}</p><p>[/ps]</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2010-05-11-net-examples-from-presentation/><span class=button__icon>←</span>
<span class=button__text>.Net Examples from Presentation</span></a></span>
<span class="button next"><a href=/posts/2010-05-11-gotten-back-from-minasi-conference/><span class=button__text>Gotten back from Minasi conference</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>