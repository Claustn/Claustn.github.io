<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Send SMS from Powershell through Unwire :: XenoBlog — Random rants</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="At work we have bought an SMS gateway service through the danish company Unwire, so after we the deal was signed we got the information on how to send email through their services, so in order to test I wrote a quick Powershell script to test it.
Of course all company/Unwire specific data has been removed, since it relates to our company account.
[ps]
&amp;lt;#
.SYNOPSIS
Send SMS through Unwire GW Server" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/2011-02-09-send-sms-from-powershell-through-unwire/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/img/favicon/green.png">



<meta name="twitter:card" content="summary" />

  <meta name="twitter:site" content="" />

<meta name="twitter:creator" content="" />


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Send SMS from Powershell through Unwire :: XenoBlog">
<meta property="og:description" content="At work we have bought an SMS gateway service through the danish company Unwire, so after we the deal was signed we got the information on how to send email through their services, so in order to test I wrote a quick Powershell script to test it.
Of course all company/Unwire specific data has been removed, since it relates to our company account.
[ps]
&amp;lt;#
.SYNOPSIS
Send SMS through Unwire GW Server" />
<meta property="og:url" content="/posts/2011-02-09-send-sms-from-powershell-through-unwire/" />
<meta property="og:site_name" content="Send SMS from Powershell through Unwire" />

  
    <meta property="og:image" content="/img/favicon/green.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

  <meta property="article:section" content="Everyday" />


  <meta property="article:published_time" content="2011-02-09 14:38:39 &#43;0000 UTC" />












</head>
<body class="">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    XenoBlog
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="https://github.com/claustn">github</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="https://github.com/claustn">github</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/2011-02-09-send-sms-from-powershell-through-unwire/">Send SMS from Powershell through Unwire</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2011-02-09
    </span>
    
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/powershell/">PowerShell</a>&nbsp;
    
    #<a href="/tags/sms/">sms</a>&nbsp;
    
  </span>
  

  

  <div class="post-content"><div>
        <p>At work we have bought an SMS gateway service through the danish company Unwire, so after we the deal was signed we got the information on how to send email through their services, so in order to test I wrote a quick Powershell script to test it.</p>
<p>Of course all company/Unwire specific data has been removed, since it relates to our company account.</p>
<p>[ps]<br>
&lt;#<br>
.SYNOPSIS<br>
Send SMS through Unwire GW Server</p>
<p>.DESCRIPTION<br>
Send SMS Text messages through Unwire.com SMS Gateway services</p>
<p>.PARAMETER Content<br>
The text that the message should contain (Strings above 160 Chars will be split) [Mandatory]</p>
<p>.PARAMETER Recipient<br>
The recipient phonenumber (Either 8 or 10 digits) [Mandatory]</p>
<p>.PARAMETER Sender<br>
The name/number that shows up on the recipients phone (Maximum 11 digits/chars)</p>
<p>.EXAMPLE<br>
PS C:\&gt;Send-SMS -Content &ldquo;Hello handsome&rdquo; -Recipient 42424242</p>
<p>.EXAMPLE<br>
PS C:\&gt; Send-SMS -Content &ldquo;Hello handsome&rdquo; -Recipient 42424242 -Sender &ldquo;IT Helpdesk&rdquo;</p>
<p>.INPUTS<br>
System.String,System.Int64,System.String</p>
<p>.OUTPUTS<br>
Sends SMS text message</p>
<p>.NOTES</p>
<p>.LINK<br>
about_functions_advanced</p>
<p>.LINK<br>
about_comment_based_help</p>
<p>#&gt;</p>
<p>function Send-SMS {<br>
[CmdletBinding()]<br>
param(<br>
[Parameter(Position=0, Mandatory=$true)]<br>
[System.String]<br>
$Content= &ldquo;Hello There&rdquo;,<br>
[Parameter(Position=1, Mandatory=$true)]<br>
[System.Int64]<br>
$Recipient=42424242,<br>
[Parameter(Position=2, Mandatory=$false)]<br>
[System.String]<br>
$Sender=&quot;IT-Drift&rdquo;<br>
)<br>
begin {</p>
<p>If ( $Recipient -notmatch &lsquo;^(\d{8}|\d{10})$&rsquo; )<br>
{Write-Host &ldquo;Error in Phone Number&rdquo;<br>
break<br>
}<br>
If ($Sender.Length -gt 11)<br>
{Write-Host &ldquo;Sender name too long&rdquo;<br>
break<br>
}<br>
[Void] [System.Reflection.Assembly]::LoadWithPartialName(&ldquo;System.Web&rdquo;)<br>
$objHTTP = New-Object -ComObject MSXML2.XMLHTTP</p>
<p>$User = &ldquo;xxxxx&rdquo;<br>
$Password = &ldquo;xxxxxx&rdquo;<br>
$AppNr = &ldquo;xxxxx&rdquo;<br>
$smsc = &ldquo;xxxxxx&rdquo;<br>
$Price = &ldquo;xxxxx&rdquo;</p>
<p>$Message = [System.Web.HttpUtility]::UrlEncode([System.Text.Encoding]::GetEncoding(&ldquo;ISO-8859-1&rdquo;).GetBytes(&ldquo;$Content&rdquo;))<br>
$SenderName = [System.Web.HttpUtility]::UrlEncode([System.Text.Encoding]::GetEncoding(&ldquo;ISO-8859-1&rdquo;).GetBytes(&ldquo;$Sender&rdquo;))</p>
<p>[String] $unwireURL = &ldquo;xxxxxxxx&rdquo;<br>
[String] $UnwireServer = &ldquo;xxxxxxxx&rdquo;<br>
[String] $UnwireHost =&quot;xxxxxxxxxx&rdquo;</p>
<p>}</p>
<p>process {</p>
<p>$PushString = @&rdquo;<br>
user=$user&amp;password=$password&amp;to=$Recipient&amp;text=$Message&amp;smsc=$smsc&amp;price=$Price&amp;type=text&amp;appnr=$AppNr&amp;from=$SenderName<br>
&ldquo;@</p>
<p>$objHTTP.open(&lsquo;POST&rsquo;, $UnwireServer, $False)</p>
<p>$objHTTP.setRequestHeader(&lsquo;POST&rsquo;, $unwireURL + ' HTTP/1.1&rsquo;)<br>
$objHTTP.setRequestHeader(&lsquo;Host&rsquo;, $UnwireHost)<br>
$objHTTP.setRequestHeader(&lsquo;User-Agent:', &lsquo;CP agent&rsquo;)<br>
$objHTTP.setRequestHeader(&lsquo;Content-Type&rsquo;, &lsquo;application/x-www-form-urlencoded&rsquo;)<br>
$objHTTP.setRequestHeader(&lsquo;Content-Length&rsquo;, $($XMLString.Length))<br>
$objHTTP.send(&ldquo;$PushString&rdquo;)<br>
$objHTTP.status<br>
$objHTTP.statusText</p>
<p>}<br>
}</p>
<p>[/ps]</p>

      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="/posts/2011-02-09-send-sms-through-bibob-with-powershell/">
                <span class="button__icon">←</span>
                <span class="button__text">Send SMS through bibob with Powershell</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="/posts/2011-01-29-change-usernamepassword-on-scheduled-tasks/">
                <span class="button__text">Change username/password on scheduled tasks.</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2020 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
