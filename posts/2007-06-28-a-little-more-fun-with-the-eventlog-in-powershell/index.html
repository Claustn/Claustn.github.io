<!doctype html><html lang=en><head><title>A little more fun with the eventlog in PowerShell :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Imagine that you want to list, the last 15 events in all the eventlogs on the system, do you have to write several lines of codes to do that, like this below??
get-eventlog -logname Application -newest 15 get-eventlog -logname System -newest 15 get-eventlog -logname Application -newest 15
Of course not, PowerShell is much smarter than that&amp;hellip;
You can use the &amp;lsquo;foreach&amp;rsquo; command.
foreach ($eventlog in (get-eventlog -list -asString)) {write-host $eventlog; get-eventlog $eventlog -newest 15}"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/2007-06-28-a-little-more-fun-with-the-eventlog-in-powershell/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="A little more fun with the eventlog in PowerShell :: XenoBlog"><meta property="og:description" content="Imagine that you want to list, the last 15 events in all the eventlogs on the system, do you have to write several lines of codes to do that, like this below??
get-eventlog -logname Application -newest 15 get-eventlog -logname System -newest 15 get-eventlog -logname Application -newest 15
Of course not, PowerShell is much smarter than that&amp;hellip;
You can use the &amp;lsquo;foreach&amp;rsquo; command.
foreach ($eventlog in (get-eventlog -list -asString)) {write-host $eventlog; get-eventlog $eventlog -newest 15}"><meta property="og:url" content="/posts/2007-06-28-a-little-more-fun-with-the-eventlog-in-powershell/"><meta property="og:site_name" content="A little more fun with the eventlog in PowerShell"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Tech Stuff"><meta property="article:published_time" content="2007-06-28 19:37:25 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://github.com/claustn>github</a></li><li><a href=/about>RSS</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://github.com/claustn>github</a></li><li><a href=/about>RSS</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/2007-06-28-a-little-more-fun-with-the-eventlog-in-powershell/>A little more fun with the eventlog in PowerShell</a></h1><div class=post-meta><span class=post-date>2007-06-28</span></div><span class=post-tags>#<a href=/tags/posh/>PoSH</a>&nbsp;
#<a href=/tags/powershell/>PowerShell</a>&nbsp;</span><div class=post-content><div><p>Imagine that you want to list, the last 15 events in all the eventlogs on the system, do you have to write several lines of codes to do that, like this below??<br><code>get-eventlog -logname Application -newest 15 get-eventlog -logname System -newest 15 get-eventlog -logname Application -newest 15</code><br>Of course not, PowerShell is much smarter than that&mldr;<br>You can use the &lsquo;foreach&rsquo; command.</p><p><code>foreach ($eventlog in (get-eventlog -list -asString)) {write-host $eventlog; get-eventlog $eventlog -newest 15}</code></p><p>This will give you the newest 15 log entries in each of the eventlogs on the system, let me try to break it down.<br> One thing that is important to know about PowerShell is how it handles () and {}<br>As in math the () parenthesis&rsquo; are evaluated first, the {} curly brackets are used for compulsory arguments.</p><p>The foreach makes the script run through all eventlogs on the system, and add them to the variable $eventlog, then PowerShell evaluates the {} arguments for each.<br><code>{write-host $eventlog; get-eventlog $eventlog -newest 15}</code><br>simply writes the variable $eventlog (this contains the name of a eventlog on the system) to the screen, then it goes on to invoke the get-eventlog again, and tells that to return the newest 15 entries, and write them to the screen.  </p><blockquote><p>Kiddo&mldr; This isnt very readable I would like to have a better indication of when a new eventlog listing is started.</p></blockquote><p>I say we can take a look at the properties of write-host (You can type help write-host -full or man write-host -full)<br>and low and behold it has a feature called background color and foregroundcolor, let try them out.</p><p><code>foreach ($eventlog in (get-eventlog -list -asString)) {write-host -foregroundcolor blue -backgroundcolor green $eventlog; get-eventlog $eventlog -newest 15}</code></p><blockquote><p>But kiddo I want some specific properties from the eventlogs, how do I do that&mldr;.</p></blockquote><p>In order to figure out what properties an obeject has, you can use the get-member command as described in another post.<br>Get-eventlog -Logname system | get-member (The -logname paramenter is required)<br>Now you have a list of properties on the eventlog object, say you would like (Index,EventID,TimeGenerated and Message)</p><p><code>foreach ($eventlog in (get-eventlog -list -asString)) {write-host -foregroundcolor blue -backgroundcolor green $eventlog; get-eventlog $eventlog -newest 15| select Index,EventID,TimeGenerated,Message}</code></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2007-07-10-playing-around-with-profiles/><span class=button__icon>←</span>
<span class=button__text>Playing around with profiles.</span></a></span>
<span class="button next"><a href=/posts/2007-06-18-getting-info-from-the-eventlog-with-powershell/><span class=button__text>Getting info from the eventlog with PowerShell</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>