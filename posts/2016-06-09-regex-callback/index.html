<!doctype html><html lang=en><head><title>Regex CallBack :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="A friend of mine had had to go through a lot of data, and substitute some values&amp;hellip; But these weren&amp;rsquo;t 1-1 replacement, he had to find the value which was in HEX and then convert them to regular characters.
The files he had to traverse had several million lines each, so certain performance considerations had to be taken.
My initial thinking was to use regular expressions, since they excel at manipulating text."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/2016-06-09-regex-callback/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Regex CallBack :: XenoBlog"><meta property="og:description" content="A friend of mine had had to go through a lot of data, and substitute some values&amp;hellip; But these weren&amp;rsquo;t 1-1 replacement, he had to find the value which was in HEX and then convert them to regular characters.
The files he had to traverse had several million lines each, so certain performance considerations had to be taken.
My initial thinking was to use regular expressions, since they excel at manipulating text."><meta property="og:url" content="/posts/2016-06-09-regex-callback/"><meta property="og:site_name" content="Regex CallBack"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Everyday"><meta property="article:published_time" content="2016-06-09 22:26:24 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://github.com/claustn>github</a></li><li><a href=/index.xml>RSS</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://github.com/claustn>github</a></li><li><a href=/index.xml>RSS</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/2016-06-09-regex-callback/>Regex CallBack</a></h1><div class=post-meta><span class=post-date>2016-06-09</span></div><div class=post-content><div><p>A friend of mine had had to go through a lot of data, and substitute some values&mldr; But these weren&rsquo;t 1-1 replacement, he had to find the value which was in HEX and then convert them to regular characters.<br>The files he had to traverse had several million lines each, so certain performance considerations had to be taken.</p><p>My initial thinking was to use regular expressions, since they excel at manipulating text. So I started playing around with the -replace operator in PowerShell</p><p>In PowerShell you can do something like:</p><pre><code>$Text -Replace '(?ismx)\[([0-9A-F]+)\]','$1'
</code></pre><p>Which will replace the matching string, with numbered capturing group 1 from the Regex in this case the HEX value matching ([0-9A-F]+) in Regex parenthesis denotes a capturing group.</p><p>But I needed to change the HEX string to a &ldquo;string&rdquo;, so I tried different methods, but the PowerShell -Replace does not support callbacks.</p><p>So what I did was to create a callback function (Just named it Callback, could be called anything)</p><p>Instead of using -Replace I use the .Net type accelerator [Regex] to define the regex, and call the ::Replace method in that, which does support callbacks</p><pre><code>$CallBack = { param($match) HexConvert -HEX $($match.Groups[1].Value) } $Regex = [regex]'(?ismx)\[([0-9A-F]+)\]' $Text = (Get-Content C:\temp\Input.txt -Raw ) [Regex]::Replace($Text,$Regex,$CallBack) | Set-Content C:\temp\Output.txt}
</code></pre><p>This literally cut the running time down from hours to minutes.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2017-05-14-monitoring-your-vms-using-screenshots/><span class=button__icon>←</span>
<span class=button__text>Monitoring your VM's using screenshots</span></a></span>
<span class="button next"><a href=/posts/2016-01-31-dsc-resource-downloader/><span class=button__text>DSC resource downloader</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>