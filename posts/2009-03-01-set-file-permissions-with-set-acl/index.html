<!doctype html><html lang=en><head><title>Set file permissions with Set-ACL :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="One of the guys at the minasi forum had a problem with setting permissions on multiple .ini files (Had to add the Deny setting to read for a certain group), he joked that I was probably able to write a powershell script to do it.. So I took the challenge, and wrote this little script.
This script will lrecurse through the InitialFolder and all of its subfolders for Desktop.Ini files, it will then loop through each of the files, and add the DENY setting on the read permission for the local administrators group."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/2009-03-01-set-file-permissions-with-set-acl/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Set file permissions with Set-ACL :: XenoBlog"><meta property="og:description" content="One of the guys at the minasi forum had a problem with setting permissions on multiple .ini files (Had to add the Deny setting to read for a certain group), he joked that I was probably able to write a powershell script to do it.. So I took the challenge, and wrote this little script.
This script will lrecurse through the InitialFolder and all of its subfolders for Desktop.Ini files, it will then loop through each of the files, and add the DENY setting on the read permission for the local administrators group."><meta property="og:url" content="/posts/2009-03-01-set-file-permissions-with-set-acl/"><meta property="og:site_name" content="Set file permissions with Set-ACL"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Tech Stuff"><meta property="article:published_time" content="2009-03-01 22:12:29 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=https://github.com/claustn>github</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=https://github.com/claustn>github</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/2009-03-01-set-file-permissions-with-set-acl/>Set file permissions with Set-ACL</a></h1><div class=post-meta><span class=post-date>2009-03-01</span></div><div class=post-content><div><p>One of the guys at the minasi forum had a problem with setting permissions on multiple .ini files (Had to add the Deny setting to read for a certain group), he joked that I was probably able to write a powershell script to do it.. So I took the challenge, and wrote this little script.</p><p>This script will lrecurse through the InitialFolder and all of its subfolders for Desktop.Ini files, it will then loop through each of the files, and add the DENY setting on the read permission for the local administrators group.<br>[sourcecode lang="posh&rdquo;]<br>$InitialFolder = &ldquo;c:\scripts\test"</p><p>$Files = Get-ChildItem $InitialFolder -include desktop.ini -recurse -force</p><p>Foreach ($File in $Files) {<br>$colRights = [System.Security.AccessControl.FileSystemRights]&ldquo;Read&rdquo;</p><p>$InheritanceFlag = [System.Security.AccessControl.InheritanceFlags]::None<br>$PropagationFlag = [System.Security.AccessControl.PropagationFlags]::None</p><p>$objType =[System.Security.AccessControl.AccessControlType]::DENY</p><p>$objUser = New-Object System.Security.Principal.NTAccount(&ldquo;Administrators&rdquo;)</p><p>$objACE = New-Object System.Security.AccessControl.FileSystemAccessRule ($objUser, $colRights, $InheritanceFlag, $PropagationFlag,$objType)</p><p>$objACL = Get-ACL $File<br>$objACL.AddAccessRule($objACE)</p><p>Set-ACL $file $objACL<br>}<br>[/sourcecode]</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2009-03-11-new-powershell-brushes-for-syntax-highlighter-plus/><span class=button__icon>←</span>
<span class=button__text>New Powershell brushes for Syntax Highlighter plus</span></a></span>
<span class="button next"><a href=/posts/2009-01-29-double-arrrgghhh/><span class=button__text>Double arrrgghhh</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>