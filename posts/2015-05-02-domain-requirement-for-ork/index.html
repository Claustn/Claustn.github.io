<!doctype html><html lang=en><head><title>Domain requirement for ORK :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="I was playing around with Microsoft ORK (Operational Readiness Kit), which is a frontend for the PowerShell deployment toolkit, aimed at hosters.
I wanted to try to do a greenfield install, using a clean Server 2012R2 machine, which had not been joined to any domain, and run everything off that machine. I had downloaded all the pre reqs, and started the install, but it kept failing.

It entered an infinite loop, trying to access the PowerShell AD provider, so my first thought is that I will just turn off the autoload of the AD provider, by setting an environment variable"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/2015-05-02-domain-requirement-for-ork/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Domain requirement for ORK :: XenoBlog"><meta property="og:description" content="I was playing around with Microsoft ORK (Operational Readiness Kit), which is a frontend for the PowerShell deployment toolkit, aimed at hosters.
I wanted to try to do a greenfield install, using a clean Server 2012R2 machine, which had not been joined to any domain, and run everything off that machine. I had downloaded all the pre reqs, and started the install, but it kept failing.

It entered an infinite loop, trying to access the PowerShell AD provider, so my first thought is that I will just turn off the autoload of the AD provider, by setting an environment variable"><meta property="og:url" content="/posts/2015-05-02-domain-requirement-for-ork/"><meta property="og:site_name" content="Domain requirement for ORK"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Everyday"><meta property="article:published_time" content="2015-05-02 22:36:05 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://github.com/claustn>github</a></li><li><a href=/index.xml>RSS</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://github.com/claustn>github</a></li><li><a href=/index.xml>RSS</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/2015-05-02-domain-requirement-for-ork/>Domain requirement for ORK</a></h1><div class=post-meta><span class=post-date>2015-05-02</span></div><div class=post-content><div><p>I was playing around with Microsoft ORK (Operational Readiness Kit), which is a frontend for the PowerShell deployment toolkit, aimed at hosters.</p><p>I wanted to try to do a greenfield install, using a clean Server 2012R2 machine, which had not been joined to any domain, and run everything off that machine. I had downloaded all the pre reqs, and started the install, but it kept failing.</p><p><a href=http://www.xipher.dk/WordPress/wp-content/uploads/2015-05-02_22-18-41.png><img src=/assets/images/2015-05-02_22-18-41-300x81.png alt=2015-05-02_22-18-41></a><br>It entered an infinite loop, trying to access the PowerShell AD provider, so my first thought is that I will just turn off the autoload of the AD provider, by setting an environment variable</p><pre><code>$env:ADFS\_LoadDefaultDrive=0
</code></pre><p>But the script still failed, so I looked at the code, and found this snippet.</p><pre><code>While (!(Test-Path &quot;AD:\&quot;)) { if (Get-Module ActiveDirectory) { Remove-Module ActiveDirectory -ErrorAction 'SilentlyContinue' sleep -Seconds 2 } Enable-PSModule ActiveDirectory -ErrorAction 'SilentlyContinue' }
</code></pre><p>This is what is creating the infinite loop, it tests to see if the AD:\ provider is loaded, if not remove the module and install it again and try to find the drive again.</p><p>I have not had time to dig through the entire script, to see if the &ldquo;installing&rdquo; machine actually needs the PowerShell AD module or not.. So for now, the machine on which you run the installer on, need to be in a domain.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2015-05-06-new-in-wmf-5-april-release/><span class=button__icon>←</span>
<span class=button__text>New in WMF 5 April release</span></a></span>
<span class="button next"><a href=/posts/2015-04-30-new-version-of-powershell-v5-april-release/><span class=button__text>New version of PowerShell v5 (April release)</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>