<!doctype html><html lang=en><head><title>MSTSC Util update :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="I was asked to update my MSTSC util, so here goes.. It will now check for the configuration file and display a message if it is not there, instead of just erroring out.
I have tested it to work on Windows 7
Here is the source code:
[sourcecode lang=&amp;quot;bash&amp;rdquo;]
#Include &amp;lt;constants .au3&amp;gt;Opt(&amp;ldquo;TrayOnEventMode&amp;rdquo;,1)
Opt(&amp;ldquo;TrayAutoPause&amp;rdquo;,0)
Opt(&amp;ldquo;TrayMenuMode&amp;rdquo;,1) ; Default tray menu items (Script Paused/Exit) will not be shown.
Global $server[100][3]
$Console = TrayCreateMenu(&amp;ldquo;Console Connect&amp;rdquo;)"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/2009-12-14-mstsc-util-update/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="MSTSC Util update :: XenoBlog"><meta property="og:description" content="I was asked to update my MSTSC util, so here goes.. It will now check for the configuration file and display a message if it is not there, instead of just erroring out.
I have tested it to work on Windows 7
Here is the source code:
[sourcecode lang=&amp;quot;bash&amp;rdquo;]
#Include &amp;lt;constants .au3&amp;gt;Opt(&amp;ldquo;TrayOnEventMode&amp;rdquo;,1)
Opt(&amp;ldquo;TrayAutoPause&amp;rdquo;,0)
Opt(&amp;ldquo;TrayMenuMode&amp;rdquo;,1) ; Default tray menu items (Script Paused/Exit) will not be shown.
Global $server[100][3]
$Console = TrayCreateMenu(&amp;ldquo;Console Connect&amp;rdquo;)"><meta property="og:url" content="/posts/2009-12-14-mstsc-util-update/"><meta property="og:site_name" content="MSTSC Util update"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Everyday"><meta property="article:published_time" content="2009-12-14 20:38:14 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://github.com/claustn>github</a></li><li><a href=https://xipher.dk/index.xml>RSS</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://github.com/claustn>github</a></li><li><a href=https://xipher.dk/index.xml>RSS</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/2009-12-14-mstsc-util-update/>MSTSC Util update</a></h1><div class=post-meta><span class=post-date>2009-12-14</span></div><div class=post-content><div><p>I was asked to update my MSTSC util, so here goes.. It will now check for the configuration file and display a message if it is not there, instead of just erroring out.</p><p>I have tested it to work on Windows 7</p><p>Here is the source code:</p><p>[sourcecode lang="bash&rdquo;]<br>#Include &lt;constants .au3></p><p>Opt(&ldquo;TrayOnEventMode&rdquo;,1)<br>Opt(&ldquo;TrayAutoPause&rdquo;,0)<br>Opt(&ldquo;TrayMenuMode&rdquo;,1) ; Default tray menu items (Script Paused/Exit) will not be shown.<br>Global $server[100][3]</p><p>$Console = TrayCreateMenu(&ldquo;Console Connect&rdquo;)<br>$Regular = TrayCreateMenu(&ldquo;Regular Connect&rdquo;)</p><p>If FileExists(&ldquo;servers.ini&rdquo;) Then<br>$data = IniReadSection ( @ScriptDir&"\servers.ini&rdquo;, &ldquo;servers&rdquo; )<br>Else<br>MsgBox(4096,&ldquo;No Ini File found&rdquo;,&ldquo;I could not find the servers.ini file, Exiting&rdquo;)<br>Exit<br>EndIf</p><p>;~ For $i = 1 To $data[0][0]<br>;~ MsgBox(4096, &ldquo;", &ldquo;Key: " & $data[$i][2] & @CRLF & &ldquo;Value: " & $data[$i][1])<br>;~ Next</p><p>$server[0][0] = $data[0][0]<br>For $i = 1 to $data[0][0]<br>$server[$i][0] = TrayCreateItem($data[$i][0], $Console)<br>TrayItemSetOnEvent(-1, &ldquo;ServerConsole&rdquo;)<br>$server[$i][1] = TrayCreateItem($data[$i][0], $Regular)<br>TrayItemSetOnEvent(-1, &ldquo;ServerRegular&rdquo;)<br>$server[$i][2] = $data[$i][1]<br>Next</p><p>TrayCreateItem("")<br>TrayCreateItem(&ldquo;About&rdquo;)<br>TrayItemSetOnEvent(-1, &ldquo;DoAbout&rdquo;)<br>TrayCreateItem("")<br>TrayCreateItem(&ldquo;Exit&rdquo;)<br>TrayItemSetOnEvent(-1, &ldquo;DoExit&rdquo;)</p><p>TraySetState()</p><p>While 1<br>Sleep(100)<br>WEnd</p><p>Func DoAbout()<br>Msgbox(64,&ldquo;About:",&ldquo;Tool by Claus T. Nielsen&rdquo;)<br>EndFunc</p><p>Func DoExit()<br>Exit<br>EndFunc</p><p>Func ServerConsole()<br>For $i = 1 to $server[0][0]<br>If $server[$i][0] = @TRAY_ID Then<br>Run(&ldquo;mstsc -v:"&$server[$i][2]&&rdquo; /F -admin&rdquo;)<br>ExitLoop<br>EndIf<br>Next<br>EndFunc</p><p>Func ServerRegular()<br>For $i = 1 to $server[0][0]<br>If $server[$i][1] = @TRAY_ID Then<br>Run(&ldquo;mstsc -v:"&$server[$i][2]&&rdquo; &ldquo;)<br>ExitLoop<br>EndIf<br>Next<br>EndFunc</p><p>[/sourcecode]</p><p>Here is an example on the servers.ini file.</p><p>[sourcecode lang="bash&rdquo;]<br>;Server.ini example<br>; Right side of the Equal sign is the server name/address,<br>; left side is the name you want displayed<br>;This files has to be located in the same dir as the .exe file.</p><p>[Servers]<br>ServerTest 10.0.0.1 = ServerTest<br>ExchangeServer = 10.0.0.2<br>Fileserver01 = Fileserver01.domain.com<br>[/sourcecode]</p><p>For those of you who trust me, here are two precompiled editions:<br><a href=http://xipher.dk/Tools/MSTSCTrayx64.exe>64 Bit</a><br><a href=http://xipher.dk/Tools/MSTSCTray.exe>32 Bit</a></p><p>EDIT<br>Sorry about that folks, seems as if there was some trouble with the HTML formatting, some of the quotes had been replaced with &ldquo;AMP;", this should be fixed now.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2010-01-24-powershell-as-a-webservice/><span class=button__icon>←</span>
<span class=button__text>Powershell as a webservice</span></a></span>
<span class="button next"><a href=/posts/2009-11-30-finding-powershell-v2/><span class=button__text>Finding Powershell V2</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>