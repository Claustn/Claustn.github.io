<!doctype html><html lang=en><head><title>Windows 7 & RSAT :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="I finally found some time today to upgrade my primary work machine to Windows 7 RTM (Yeah). Since I do a lot of system administration one of the first things I put on there was my Powershell tools and RSAT. I went and got the RSAT tools from the MS website, I install it, go into &amp;ldquo;turn on/off Windows features&amp;rdquo; menu and click the to level check for RemoteAdministrationTools, in the hope that it would select all the admin tools, but no!"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/2009-09-04-windows-7-rsat/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Windows 7 & RSAT :: XenoBlog"><meta property="og:description" content="I finally found some time today to upgrade my primary work machine to Windows 7 RTM (Yeah). Since I do a lot of system administration one of the first things I put on there was my Powershell tools and RSAT. I went and got the RSAT tools from the MS website, I install it, go into &amp;ldquo;turn on/off Windows features&amp;rdquo; menu and click the to level check for RemoteAdministrationTools, in the hope that it would select all the admin tools, but no!"><meta property="og:url" content="/posts/2009-09-04-windows-7-rsat/"><meta property="og:site_name" content="Windows 7 & RSAT"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Everyday"><meta property="article:published_time" content="2009-09-04 23:33:28 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=https://github.com/claustn>github</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=https://github.com/claustn>github</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/2009-09-04-windows-7-rsat/>Windows 7 & RSAT</a></h1><div class=post-meta><span class=post-date>2009-09-04</span></div><span class=post-tags>#<a href=/tags/dism/>Dism</a>&nbsp;
#<a href=/tags/posh/>PoSH</a>&nbsp;
#<a href=/tags/ps/>PS</a>&nbsp;</span><div class=post-content><div><p>I finally found some time today to upgrade my primary work machine to Windows 7 RTM (Yeah). Since I do a lot of system administration one of the first things I put on there was my Powershell tools and RSAT. I went and got the RSAT tools from the MS website, I install it, go into &ldquo;turn on/off Windows features&rdquo; menu and click the to level check for RemoteAdministrationTools, in the hope that it would select all the admin tools, but no!<br>I have to check each and everyone..</p><p>Then I remembered a while back on the Minasi forum, it was discussed if there was an easier way, and Mark said: &ldquo;There is probably a one line DISM command for that&rdquo;, so I took a look at DISM, and found that to my (albeit limited) knowledge there was no way to install all the tools at once.</p><p>So I thought to myself, well I guess I have to do it in powershell then, so I started out writing a small script to enable all the admin tools one by one.</p><p>Then suddenly Marks words sprung to mind again, &ldquo;there is probably a DISM oneliner to do this), so I rewrote my little script to a oneliner, here is what I ended up with:<br>[ps]</p><h1 id=heading><a href=#heading class=hanchor arialabel=Anchor>&#8983;</a></h1><p>#Enable RSAT features<br>dism /online /get-features | Select-String -Pattern remote* | %{$Exec = &ldquo;dism.exe /online /enable-feature /featurename:RemoteServerAdministrationTools /featurename:&rdquo; + ($_).ToString().Replace(&lsquo;Feature Name : &lsquo;,''); Invoke-expression $Exec}<br>[/ps]<br>Dism requires admin permissions, so you need to run this elevated.</p><p>Here is what it does:<br>[ps]<br>dism /online /get-features<br>[/ps]<br>Uses DISM to retrieve a list of available &ldquo;features&rdquo;<br>That list is then piped into a Select-string statement, that selects all that contain the string &ldquo;Remote*", which luckily all the admin tools does :)</p><p>Each of the selected strings are then &ldquo;piped along the pipeline&rdquo; in the next command, which is a bit more complicated:</p><p>[ps]<br>%{$Exec = &ldquo;dism.exe /online /enable-feature /featurename:RemoteServerAdministrationTools /featurename:&rdquo; + ($_).ToString().Replace(&lsquo;Feature Name : &lsquo;,''); Invoke-expression $Exec}<br>[/ps]<br>% = foreach, so foreach string the Select-String returns, I start to build the $exec variable, the first part of the variable is just text <strong>&ldquo;dism.exe /online /enable-feature /featurename:RemoteServerAdministrationTools /featurename:"</strong> this next part is where the feature name is extracted: <strong>($_).ToString().Replace(&lsquo;Feature Name : &lsquo;,'')</strong>. What it does is it converts the output from Select_String ($_) into a string, on that string it replaces &ldquo;&lsquo;Feature Name : &ldquo;, with nothing &ldquo;", so that the $exec variable will end up containing the the initial string, plus the name of the &ldquo;current&rdquo; &ldquo;feature&rdquo; in the pipeline, giving a full command that can be executed, something like this <strong>dism.exe /online /enable-feature /featurename:RemoteServerAdministrationTools /featurename:RemoteServerAdministrationTools-Roles-AD</strong>. Then it is &ldquo;executed&rdquo; by the Invoke-expression $exec.</p><p>So since what I do is just creating a regular commandline expression and executing it, there is not reason why I cannot just export the result to a batch file, which I can edit and run.<br>[ps]</p><h1 id=heading-1><a href=#heading-1 class=hanchor arialabel=Anchor>&#8983;</a></h1><p>#Output DISM RSAT commands to file<br>dism /online /get-features | Select-String -Pattern remote* | %{$Exec = &ldquo;dism.exe /online /enable-feature /featurename:RemoteServerAdministrationTools /featurename:&rdquo; + ($_).ToString().Replace(&lsquo;Feature Name : &lsquo;,'');Out-File -InputObject $Exec -FilePath c:\test.bat}<br>[/ps]</p><p>Hope this was usefull</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2009-09-14-right-click-to-mount-vhd-files/><span class=button__icon>←</span>
<span class=button__text>Right click to mount vhd files</span></a></span>
<span class="button next"><a href=/posts/2009-08-15-the-scripting-guys-have-done-it-again/><span class=button__text>"The Scripting Guy(s)) have done it again.</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>