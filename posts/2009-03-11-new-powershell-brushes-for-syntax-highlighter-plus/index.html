<!doctype html><html lang=en><head><title>New Powershell brushes for Syntax Highlighter plus :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Since I once in a while post powershell scripts on my site, I like that fact that I can have them color highlighted for better readability, so I played around with several different syntax highlighters, but none of them was able to do powershell, so I created a brush for Syntax highligther plus.
This is my initial attempt, updated to work with Syntax Highlighter plus 2
[Sourcecode lang='posh&amp;rsquo;]
 http://www.xipher.dk  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, version 3 of the License."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/2009-03-11-new-powershell-brushes-for-syntax-highlighter-plus/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="New Powershell brushes for Syntax Highlighter plus :: XenoBlog"><meta property="og:description" content="Since I once in a while post powershell scripts on my site, I like that fact that I can have them color highlighted for better readability, so I played around with several different syntax highlighters, but none of them was able to do powershell, so I created a brush for Syntax highligther plus.
This is my initial attempt, updated to work with Syntax Highlighter plus 2
[Sourcecode lang='posh&amp;rsquo;]
 http://www.xipher.dk  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, version 3 of the License."><meta property="og:url" content="/posts/2009-03-11-new-powershell-brushes-for-syntax-highlighter-plus/"><meta property="og:site_name" content="New Powershell brushes for Syntax Highlighter plus"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Tech Stuff"><meta property="article:published_time" content="2009-03-11 19:56:46 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://github.com/claustn>github</a></li><li><a href=/index.xml>RSS</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://github.com/claustn>github</a></li><li><a href=/index.xml>RSS</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/2009-03-11-new-powershell-brushes-for-syntax-highlighter-plus/>New Powershell brushes for Syntax Highlighter plus</a></h1><div class=post-meta><span class=post-date>2009-03-11</span></div><div class=post-content><div><p>Since I once in a while post powershell scripts on my site, I like that fact that I can have them color highlighted for better readability, so I played around with several different syntax highlighters, but none of them was able to do powershell, so I created a brush for Syntax highligther plus.</p><p>This is my initial attempt, updated to work with Syntax Highlighter plus 2<br>[Sourcecode lang='posh&rsquo;]</p><h1 id=heading><a href=#heading class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=httpwwwxipherdk><a href=http://www.xipher.dk>http://www.xipher.dk</a><a href=#httpwwwxipherdk class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=heading-1><a href=#heading-1 class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=this-program-is-free-software-you-can-redistribute-it-andor-modify>This program is free software: you can redistribute it and/or modify<a href=#this-program-is-free-software-you-can-redistribute-it-andor-modify class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=it-under-the-terms-of-the-gnu-general-public-license-as-published-by>it under the terms of the GNU General Public License as published by<a href=#it-under-the-terms-of-the-gnu-general-public-license-as-published-by class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=the-free-software-foundation-version-3-of-the-license>the Free Software Foundation, version 3 of the License.<a href=#the-free-software-foundation-version-3-of-the-license class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=heading-2><a href=#heading-2 class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=this-program-is-distributed-in-the-hope-that-it-will-be-useful>This program is distributed in the hope that it will be useful,<a href=#this-program-is-distributed-in-the-hope-that-it-will-be-useful class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=but-without-any-warranty-without-even-the-implied-warranty-of>but WITHOUT ANY WARRANTY; without even the implied warranty of<a href=#but-without-any-warranty-without-even-the-implied-warranty-of class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=merchantability-or-fitness-for-a-particular-purpose-see-the>MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the<a href=#merchantability-or-fitness-for-a-particular-purpose-see-the class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=gnu-general-public-license-for-more-details>GNU General Public License for more details.<a href=#gnu-general-public-license-for-more-details class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=heading-3><a href=#heading-3 class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=you-should-have-received-a-copy-of-the-gnu-general-public-license>You should have received a copy of the GNU General Public License<a href=#you-should-have-received-a-copy-of-the-gnu-general-public-license class=hanchor arialabel=Anchor>&#8983;</a></h1><h1 id=along-with-this-program-if-not-see-http-http>along with this program. If not, see .<a href=#along-with-this-program-if-not-see-http-http class=hanchor arialabel=Anchor>&#8983;</a></h1><p>SyntaxHighlighter.Brushes.PoSh = function()<br>{<br>var builtins = &lsquo;ForEach-Object Format-Custom Format-List Format-Table Format-Wide Get-Acl Get-Alias Get-AuthenticodeSignature Get-ChildItem ' +<br>&lsquo;Disable-PSBreakpoint Disable-QADUser Disconnect-EventListener Disconnect-QADService Enable-PSBreakpoint Enable-QADUser Export-Alias Export-Clixml Export-Console ' +<br>&lsquo;Get-Content Get-Credential Get-Culture Get-Date Get-Event Get-EventBinding Get-EventLog Get-ExecutionPolicy Get-Help ' +<br>&lsquo;Get-PSJob Get-PSProvider Get-PSSnapin Get-QADComputer Get-QADGroup Get-QADGroupMember Get-QADObject Get-QADPasswordSettingsObject Get-QADPSSnapinSettings ' +<br>&lsquo;Get-Runspace Get-Service Get-TraceSource Get-UICulture Get-Unique Get-Variable Get-WmiObject Group-Object Import-Alias ' +<br>&lsquo;Import-Csv Import-LocalizedData Invoke-Expression Invoke-History Invoke-Item Invoke-WmiMethod Join-Path Measure-Command Measure-Object ' +<br>&lsquo;Move-ItemProperty Move-QADObject New-Alias New-Event New-Item New-ItemProperty New-Object New-PSBreakpoint New-PSDrive ' +<br>&lsquo;New-QADObject New-QADPasswordSettingsObject New-QADUser New-Runspace New-Service New-TimeSpan New-Variable Out-Default Out-File ' +<br>&lsquo;Out-Host Out-Null Out-Printer Out-String Pop-Location Push-Location Read-Host Receive-PSJob Remove-Item ' +<br>&lsquo;Remove-PSBreakpoint Remove-PSDrive Remove-PSJob Remove-PSSnapin Remove-QADGroupMember Remove-QADObject Remove-QADPasswordSettingsObjectAppliesTo Remove-Runspace Remove-Variable ' +<br>&lsquo;Rename-Item Rename-ItemProperty Rename-QADObject Resolve-Path Restart-Service Resume-Service Select-Object Select-String Set-Acl ' +<br>&lsquo;Set-AuthenticodeSignature Set-Content Set-Date Set-ExecutionPolicy Set-Item Set-ItemProperty Set-Location Set-PSDebug Set-QADGroup ' +<br>&lsquo;Set-QADPSSnapinSettings Set-QADUser Set-Service Set-TraceSource Set-Variable Set-WmiInstance Sort-Object Split-Path Start-KeyHandler ' +<br>&lsquo;Start-Service Start-Sleep Start-Transcript Step-Into Step-Out Step-Over Stop-KeyHandler Stop-Process Stop-PSJob ' +<br>&lsquo;Stop-Transcript Suspend-Service Tee-Object Test-Path Trace-Command Unlock-QADUser Update-FormatData Update-TypeData Wait-PSJob ' +<br>&lsquo;Write-Debug Write-Error Write-Host Write-Output Write-Progress Write-Verbose Write-Warning ' +<br>&lsquo;suspend test times trap type typeset ulimit umask unalias unset wait&rsquo;;</p><p>var keywords = &lsquo;case do done elif elseif esac fi for function if in select then ' +<br>&lsquo;-band -bor -bnot -match -notmatch -like -notlike -eq -ne -gt -ge -lt -le -is ' +<br>&lsquo;-imatch -inotmatch -ilike -inotlike -ieq -ine -igt -ige -ilt -ile ' +<br>&lsquo;time until while filter foreach not ft sort&rsquo;;</p><p>this.regexList = [<br>/* comments */<br>{regex: SyntaxHighlighter.RegexLib.SingleLinePerlComments, css: &lsquo;comment&rsquo;},<br>/* text qualifiers */<br>{regex: SyntaxHighlighter.RegexLib.DoubleQuotedString, css: &lsquo;string&rsquo;},<br>{regex: SyntaxHighlighter.RegexLib.SingleQuotedString, css: &lsquo;string&rsquo;},<br>/* deliminators */<br>{regex: new RegExp('[()[\]{}]', &lsquo;g&rsquo;), css: &lsquo;delim&rsquo;},<br>/* variables */<br>{regex: new RegExp('\$\w+&rsquo;, &lsquo;g&rsquo;), css: &lsquo;vars&rsquo;},<br>{regex: new RegExp('\w+=&rsquo;, &lsquo;g&rsquo;), css: &lsquo;vars&rsquo;},<br>/* flags */<br>{regex: new RegExp('\s-\w+&rsquo;, &lsquo;g&rsquo;), css: &lsquo;test&rsquo;},<br>/* builtins */<br>{regex: new RegExp(this.GetKeywords(builtins), &lsquo;igm&rsquo;), css: &lsquo;builtin&rsquo;},<br>/* keywords */<br>{regex: new RegExp(this.GetKeywords(keywords), &lsquo;igm&rsquo;), css: &lsquo;keyword&rsquo;}<br>];</p><p>};</p><p>SyntaxHighlighter.Brushes.PoSh.prototype = new SyntaxHighlighter.Highlighter();<br>SyntaxHighlighter.Brushes.PoSh.Aliases = [&lsquo;PoSh&rsquo;, &lsquo;ps&rsquo;];</p><p>[/sourcecode]</p><p>I modified a version made by Joel Bennet to work with version 2 as well.</p><p>[sourcecode lang='posh&rsquo;]</p><p>/*Updated to v2 by Claus T Nielsen (Xipher.dk */<br>/* Powershell 1.0 syntax contributed by Joel Bennett */<br>SyntaxHighlighter.brushes.PowerShell = function()<br>{<br>var keywords = &lsquo;while until trap switch return ref process param in if global: function foreach for finally filter end elseif else do default continue break begin \? % #script #private #local #global&rsquo;;</p><p>var operators = &lsquo;and as band bnot bor bxor casesensitive ccontains ceq cge cgt cle clike clt cmatch cne cnotcontains cnotlike cnotmatch contains creplace eq exact f file ge gt icontains ieq ige igt ile ilike ilt imatch ine inotcontains inotlike inotmatch ireplace is isnot le like lt match ne not notcontains notlike notmatch or regex replace wildcard&rsquo;;</p><p>var verbs = &lsquo;Write Wrap Width Where Whatif Warning Wait Version Verify Verbose Value UserName URL Update Unlock Unique Uninstall TypeName TrustLevel Trusted Truncate Trace TimeStamp TimeOut TID Test Temp Tee Suspend Strict Stop Statistic State Start Split Speed SortBy Sort Size SID Shortname Set Send Select Scope SaveCred Role Retry Resume Restore Restart Resolve Resize Repair Rename Remove Regex Recurse Receive Reason ReadOnly Read Push Property Prompt Privilege Priority PrinterName PrincipalName PortName Pop Ping Password PassThru ParentID Parameter Owner Overwrite Output Out Operation Notify NewLine New Name Move Most Modified Minimum Migrate Merge Measure Maximum MacName LogName Log Lock Location LineCount Limit KeyLength KeyContainerName KeyAlgorithm Join JobName IpAddress Invoke Interval InterfaceName Interactive Install Insert Input Initialize Incremental Include Import Ignore Id Group Get From Format ForEach Force Follow Filter FileName Fast Export Exclude Exact EventName ErrorLimit ErrorLevel Erase Encrypt Encoding Enable Elapsed DriveName Drain DomainName Disconnect Disable DirectoryName Description Descending Delete Default Debug Data Verbs CSPType CSPName Created Create Count Copy ConvertTo ConvertFrom Convert Continuous Connect Confirm ComputerName Compress Compatible Compare Command ClusterName Clear ClassName Checkpoint Char CertUsage CertSubjectName CertStoreLocation CertSerialNumber CertRequestFileName CertIssuerName CertFile CaseSensitive Cache BlockCount Binary Before AttributeName AssemblyName Ascending As ApplicationName Allocation All After Add ACL Accessed&rsquo;;</p><p>this.regexList = [<br>{ regex: SyntaxHighlighter.regexLib.singleLinePerlComments, css: &lsquo;color4&rsquo; }, // one line comments<br>{ regex: new RegExp('@"\n[\s\S]*?\n&rdquo;@', &lsquo;gm&rsquo;), css: &lsquo;string&rsquo; }, // double quoted here-strings<br>{ regex: new RegExp("@'\n[\s\S]*?\n&rsquo;@", &lsquo;gm&rsquo;), css: &lsquo;string&rsquo; }, // single quoted here-strings<br>{ regex: new RegExp('"(?:\$\([^\)]*\)|[^&rdquo;]|<code>")*[^</code>]"',&lsquo;g&rsquo;), css: &lsquo;string&rsquo; }, // double quoted strings<br>{ regex: new RegExp("'[^&rsquo;]*'", &lsquo;g&rsquo;), css: &lsquo;string&rsquo; }, // single quoted strings<br>{ regex: new RegExp('(?:&lsquo;+verbs.replace(/ /g, &lsquo;\b|\b&rsquo;)+&rsquo;)-[a-zA-Z_][a-zA-Z0-9_]*', &lsquo;gmi&rsquo;), css: &lsquo;cmdlet&rsquo; }, // cmdlets<br>{ regex: new RegExp('\[[A-Z_\[][A-Z0-9_. ,\[\]]*\]*', &lsquo;gi&rsquo;), css: &lsquo;color2&rsquo; }, // .Net [Type]s<br>{ regex: new RegExp('\$(?:(?:global|script|private|env):)?[A-Z0-9_]+&rsquo;, &lsquo;gi&rsquo;), css: &lsquo;variable&rsquo; },// $variables<br>{ regex: new RegExp(this.getKeywords(keywords), &lsquo;gmi&rsquo;), css: &lsquo;keyword&rsquo; }, // keywords<br>{ regex: new RegExp('-&lsquo;+this.getKeywords(operators), &lsquo;gmi&rsquo;), css: &lsquo;constants&rsquo; }, // operators<br>{ regex: new RegExp('\s+-[a-zA-Z_][a-zA-Z0-9_]*', &lsquo;gmi&rsquo;), css: &lsquo;color1&rsquo; } // operators<br>]</p><p>};</p><p>SyntaxHighlighter.brushes.PowerShell.prototype = new SyntaxHighlighter.Highlighter();<br>SyntaxHighlighter.brushes.PowerShell.aliases = [&lsquo;powershell&rsquo;, &lsquo;posh&rsquo;, &lsquo;ps&rsquo;];</p><p>[/sourcecode]</p><p>Be aware that compared to version 1 of the brushes you can no longer have specific css settings in the brush (previously you could define font/colors for different datatypes/keywords in the brush), this has been changed inversion 2 because of a new theme options.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2009-03-11-get-mailboxinfo-powershell-script/><span class=button__icon>←</span>
<span class=button__text>Get-Mailboxinfo Powershell script</span></a></span>
<span class="button next"><a href=/posts/2009-03-01-set-file-permissions-with-set-acl/><span class=button__text>Set file permissions with Set-ACL</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>