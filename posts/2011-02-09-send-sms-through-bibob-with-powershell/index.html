<!doctype html><html lang=en><head><title>Send SMS through bibob with Powershell :: XenoBlog — Random rants</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="I thought I had posted this script more than a year ago, but apparently I have not. It is quite similar to the script, I posted recently sending SMS messages through unwire, this just allows bibob customers to send messages through bibobs online gateway.
One thing to notice is that you are required to convert your password in an MD5 hash, before you send it. Here is a function to convert your plain passwords into an MD5 hash (Adapted from a script by Dennis Damen)"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/posts/2011-02-09-send-sms-through-bibob-with-powershell/><link rel=stylesheet href=/assets/style.css><link rel=stylesheet href=/assets/green.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Send SMS through bibob with Powershell :: XenoBlog"><meta property="og:description" content="I thought I had posted this script more than a year ago, but apparently I have not. It is quite similar to the script, I posted recently sending SMS messages through unwire, this just allows bibob customers to send messages through bibobs online gateway.
One thing to notice is that you are required to convert your password in an MD5 hash, before you send it. Here is a function to convert your plain passwords into an MD5 hash (Adapted from a script by Dennis Damen)"><meta property="og:url" content="/posts/2011-02-09-send-sms-through-bibob-with-powershell/"><meta property="og:site_name" content="Send SMS through bibob with Powershell"><meta property="og:image" content="/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Everyday"><meta property="article:published_time" content="2011-02-09 21:55:42 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>XenoBlog</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=https://github.com/claustn>github</a></li><li><a href=https://xipher.dk/index.xml>RSS</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=https://github.com/claustn>github</a></li><li><a href=https://xipher.dk/index.xml>RSS</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/2011-02-09-send-sms-through-bibob-with-powershell/>Send SMS through bibob with Powershell</a></h1><div class=post-meta><span class=post-date>2011-02-09</span></div><span class=post-tags>#<a href=/tags/bibob/>bibob</a>&nbsp;
#<a href=/tags/powershell/>PowerShell</a>&nbsp;
#<a href=/tags/sms/>sms</a>&nbsp;</span><div class=post-content><div><p>I thought I had posted this script more than a year ago, but apparently I have not. It is quite similar to the script, I posted recently sending SMS messages through unwire, this just allows bibob customers to send messages through bibobs online gateway.</p><p>One thing to notice is that you are required to convert your password in an MD5 hash, before you send it. Here is a function to convert your plain passwords into an MD5 hash (Adapted from a script by Dennis Damen)</p><p>[ps]<br>Function New-MD5Hash {<br>param(<br>[Parameter(Position=0, Mandatory=$true)]<br>[System.String]<br>$inputString<br>)<br>$cryptoServiceProvider = [System.Security.Cryptography.MD5CryptoServiceProvider];<br>$hashAlgorithm = new-object $cryptoServiceProvider<br>$hashByteArray = $hashAlgorithm.ComputeHash($([Char[]]$inputString));<br>foreach ($byte in $hashByteArray) { if ($byte -lt 16) {$result += “0{0:X}” -f $byte } else { $result += “{0:X}” -f $byte }}<br>write-host $result<br>}<br>[/ps]<br>Example of usage:</p><pre><code>New-MD5Hash -inputString &quot;Pa$$W0rd1&quot;
</code></pre><p>Here is the bibob send sms script.<br>[ps]<br>&lt;#<br>.SYNOPSIS<br>Send SMS through Bibob (Danish mobile phone company)</p><p>.DESCRIPTION<br>Send SMS Text messages through bibob SMS Gateway services</p><p>.PARAMETER Content<br>The text that the message should contain (Strings above 160 Chars will be split) [Mandatory]</p><p>.PARAMETER Recipient<br>The recipient phonenumber (8 digits) [Mandatory]</p><p>.EXAMPLE<br>PS C:\>Send-SMS -Content &ldquo;Hello handsome&rdquo; -Recipient 42424242</p><p>.INPUTS<br>System.String,System.Int32</p><p>.OUTPUTS<br>Sends SMS text message</p><p>.NOTES</p><p>.LINK<br>about_functions_advanced</p><p>.LINK<br>about_comment_based_help</p><p>#></p><p>function Send-SMS {<br>[CmdletBinding()]<br>param(<br>[Parameter(Position=0, Mandatory=$true)]<br>[System.String]<br>$Content= &ldquo;Hello Handsome&rdquo;,<br>[Parameter(Position=1)]<br>[System.Int32]<br>$Recipient=42424242<br>)<br>begin {<br>If ($Recipient -notmatch &lsquo;^(\d{8})$&rsquo; )<br>{Write-Host &ldquo;Error in Phone Number&rdquo;<br>break<br>}<br>$Username = &ldquo;42424242&rdquo; # The same as your login to bibob.dk (You cannot spoof you sender number, so it is used as sender as well)<br>$MD5Password = &ldquo;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&rdquo;</p><p>}</p><p>process {<br>$objHTTP = New-Object -ComObject MSXML2.XMLHTTP<br>$SoapServer = &ldquo;<a href=https://www.bibob.dk/SmsSender.asmx%22>https://www.bibob.dk/SmsSender.asmx"</a></p><p>$XMLString = @&rdquo;<br>&lt;?xml version="1.0&rdquo; encoding="utf-8&rdquo;?><br>&lt;soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance&rdquo; xmlns:xsd="http://www.w3.org/2001/XMLSchema&rdquo; xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><br>&lt;soap:Body><br>&lt;SendMessage xmlns="http://www.bibob.dk/"><br>&lt;cellphone>$Username&lt;/cellphone><br>&lt;password>$MD5Password&lt;/password><br>&lt;smsTo><br>&lt;string>$recipient&lt;/string><br>&lt;/smsTo><br>&lt;smscontents>$content&lt;/smscontents><br>&lt;fromNumber>$username&lt;/fromNumber><br>&lt;/SendMessage><br>&lt;/soap:Body><br>&lt;/soap:Envelope><br>&ldquo;@</p><p>$objHTTP.open(&lsquo;POST&rsquo;, $SoapServer, $False)</p><p>$objHTTP.setRequestHeader(&lsquo;Man&rsquo;, &lsquo;POST&rsquo; + ' ' + $SoapServer + ' HTTP/1.1&rsquo;)<br>$objHTTP.setRequestHeader(&lsquo;Host&rsquo;, &lsquo;<a href=http://www.bibob.dk>www.bibob.dk</a>&rsquo;)<br>$objHTTP.setRequestHeader(&lsquo;Content-Type&rsquo;, &lsquo;text/xml; charset=utf-8&rsquo;)<br>$objHTTP.setRequestHeader(&lsquo;Content-Length&rsquo;, $($XMLString.Length))<br>$objHTTP.setRequestHeader(&lsquo;SOAPAction&rsquo;, &lsquo;<a href="http://www.bibob.dk/SendMessage'">http://www.bibob.dk/SendMessage'</a>)</p><p>$objHTTP.send($XMLString)<br>}<br>}</p><p>[/ps]</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/2011-06-17-fix-2008r2-scheduled-tasks/><span class=button__icon>←</span>
<span class=button__text>Fix 2008R2 scheduled tasks</span></a></span>
<span class="button next"><a href=/posts/2011-02-09-send-sms-from-powershell-through-unwire/><span class=button__text>Send SMS from Powershell through Unwire</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2020 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/assets/main.js></script><script src=/assets/prism.js></script></div></body></html>